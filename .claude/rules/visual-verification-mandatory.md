# 視覚的検証 必須規則

## 適用対象

### 対象プロジェクト
**顧客にアプリケーション・サービスを提供するプロジェクトのみ**

| 対象 | 例 |
|------|-----|
| モバイルアプリ | MoneyTracker, SecretVault, SleepWise |
| デスクトップアプリ | WinLayout, WallpaperSync, XVideoSaver |
| Webサービス | GlobalSkillPress, SnapEdit |

### 対象外
| 非対象 | 理由 |
|--------|------|
| OrchestratorUI | 内部ツール（顧客向けではない） |
| 内部ライブラリ | UIを持たない |
| バックエンドのみ | 視覚的要素がない |

## 視覚的検証フェーズとは

**AIが「本番投入したい」「プラットフォーム申請したい」と判断した時点で、それを実行する前に突入する必須フェーズ**

```
開発完了 → AIが「公開準備完了」と判断
                    ↓
        ┌─────────────────────────────┐
        │   視覚的検証フェーズ突入     │
        │                             │
        │  1. スクリーンショット取得   │
        │  2. AI分析・問題特定        │
        │  3. 競合比較・差別化確認     │
        │  4. 修正・再検証            │
        │  5. 1万回の修正サイクル      │
        │                             │
        │  → 全項目PASS まで繰り返し   │
        └─────────────────────────────┘
                    ↓
        視覚的検証フェーズ完了（人間承認後）
                    ↓
        本番投入・プラットフォーム申請
```

### 重要な認識

- **「コード完成 = 公開準備完了」ではない**
- **視覚的検証フェーズは1回で終わらない**
- **100回どころか1万回の修正を経て初めて公開可能**
- **プラットフォーム申請は視覚的検証フェーズ完了後の最終ステップ**

## 実施タイミング（ゲート方式）

| ゲート | 条件 | 視覚検証 |
|--------|------|---------|
| 開発中 | 随時 | 推奨（問題早期発見） |
| **公開申請前** | AIが公開準備完了と判断 | **必須（ゲート通過条件）** |
| 公開後アップデート前 | 変更を含むリリース | **必須（回帰確認）** |

### ゲート通過条件

視覚的検証フェーズを完了し、以下を満たすまで**本番投入禁止**:

1. 全画面スクリーンショット取得完了
2. AI分析で重大問題0件
3. 競合比較で同等以上
4. 人間による最終確認・承認

## 検証プロセス（1万回修正サイクル）

### 視覚的検証フェーズの心構え

**「AI製アプリは出来が悪い」という前提で臨む**

- AIが「完成」と思っても、人間の目には粗が見える
- 1回の検証で終わることは絶対にない
- 100回、1000回、1万回の修正を経て初めて「公開可能」
- 妥協は収益0円に直結する

### 修正サイクル

```
┌──────────────────────────────────────────────────────┐
│  修正サイクル（無限ループ）                          │
│                                                      │
│  1. スクリーンショット取得                           │
│  2. AI分析（Claude Vision）                         │
│  3. 問題リスト作成                                   │
│  4. 修正実施                                         │
│  5. 再度スクリーンショット取得 → 1に戻る            │
│                                                      │
│  終了条件: 問題0件 AND 競合以上 AND 人間承認         │
└──────────────────────────────────────────────────────┘
```

### Step 1: 視覚検証システム構築
```
1. プロジェクトに EVIDENCE/visual-verification/ を作成
2. スクリーンショット取得スクリプトを準備
   - Tauri: Playwright + PowerShell
   - Flutter: ADB + integration_test
   - Web: Playwright
3. 自動化パイプラインを構築
```

### Step 2: 全画面スクリーンショット取得
```
- 全ページ/全画面をキャプチャ
- 各状態（初期/ロード中/エラー/成功）を取得
- レスポンシブ対応の場合は複数解像度
- ダークモード/ライトモード両方
```

### Step 3: AI分析・問題特定
```
Claude Visionで以下を分析:
- UIレイアウトの崩れ
- テキストの見切れ/重なり
- カラーコントラスト問題
- インタラクション不備
- アクセシビリティ違反
- デザインの洗練度不足
- 競合と比較した見劣り
```

### Step 4: 競合比較（徹底的に）
```
- 類似アプリを5つ以上インストール/使用
- 機能一覧を作成し、自アプリと比較
- 差別化ポイントが明確か確認
- 競合より劣る点を全て特定
- 「競合と同等」は不合格（それでは選ばれない）
```

### Step 5: 修正・再検証（繰り返し）
```
- 発見した問題を全て修正
- 再度スクリーンショット取得
- 再度AI分析
- 問題0件になるまで繰り返し
- 「これで良い」と思っても、もう1回チェック
```

### 修正回数の目安

| レベル | 修正回数 | 状態 |
|--------|---------|------|
| 初期 | 1-10回 | 明らかな問題の修正 |
| 中期 | 10-100回 | 細かい調整 |
| 後期 | 100-1000回 | 洗練・磨き上げ |
| 完成 | 1000回以上 | 競合を圧倒する品質 |

**1万回の修正は誇張ではない。本気で収益化するならそれくらい必要。**

## 検証チェックリスト

### UI/UX品質
| 項目 | チェック内容 | 必須 |
|------|-------------|------|
| レイアウト | 崩れ・はみ出しなし | ✅ |
| テキスト | 見切れ・重なりなし | ✅ |
| 画像 | 適切なサイズ・表示 | ✅ |
| カラー | コントラスト比4.5:1以上 | ✅ |
| フォント | 可読性確保 | ✅ |
| 間隔 | 一貫したスペーシング | ✅ |

### インタラクション
| 項目 | チェック内容 | 必須 |
|------|-------------|------|
| ボタン | クリック可能領域適切 | ✅ |
| フォーム | 入力・送信動作 | ✅ |
| ナビゲーション | 全リンク動作確認 | ✅ |
| フィードバック | ローディング/成功/エラー表示 | ✅ |

### 競合比較
| 項目 | チェック内容 | 必須 |
|------|-------------|------|
| 基本機能 | 競合と同等以上 | ✅ |
| 差別化 | 明確な付加価値あり | ✅ |
| UX | 競合以上の使いやすさ | ✅ |

### アクセシビリティ
| 項目 | チェック内容 | 必須 |
|------|-------------|------|
| キーボード操作 | Tab/Enter操作可能 | ✅ |
| スクリーンリーダー | 適切なラベル付け | 推奨 |
| フォーカス表示 | 明確なフォーカス状態 | ✅ |

## 検証結果記録

各プロジェクトの `EVIDENCE/visual-verification/` に以下を保存:

```
EVIDENCE/visual-verification/
├── screenshots/           # スクリーンショット
│   ├── YYYYMMDD_HHMMSS/  # タイムスタンプ別
│   │   ├── page1.png
│   │   ├── page2.png
│   │   └── ...
├── reports/              # 検証レポート
│   └── verification_YYYYMMDD.md
└── issues/               # 発見した問題
    └── issue_001.md
```

## 検証レポートテンプレート

```markdown
# 視覚的検証レポート

**プロジェクト**: {プロジェクト名}
**検証日**: {YYYY-MM-DD HH:MM}
**検証者**: AI (Claude)

## 検証範囲
- [ ] 全ページ/画面
- [ ] 全機能
- [ ] レスポンシブ対応

## 結果サマリー
| カテゴリ | 合格 | 警告 | 不合格 |
|---------|------|------|--------|
| UI/UX | X | X | X |
| インタラクション | X | X | X |
| アクセシビリティ | X | X | X |
| 競合比較 | X | X | X |

## 発見した問題
1. [重大] ...
2. [警告] ...

## 競合との比較
| 機能 | 自アプリ | 競合A | 競合B |
|------|---------|-------|-------|
| ... | ✅/❌ | ✅/❌ | ✅/❌ |

## 総合判定
- [ ] 🟢 PASS - リリース可
- [ ] 🟡 CONDITIONAL - 軽微な修正後リリース可
- [ ] 🔴 FAIL - 修正必須

## 次のアクション
1. ...
```

## 違反時の対応

### リリース前に視覚検証未実施
```
🔴 リリース禁止
→ 視覚検証を実施し、全項目PASSになるまでリリース不可
```

### 問題発見後の未修正リリース
```
🔴 リリース禁止
→ 重大/中程度の問題は修正必須
→ 軽微な問題は次回リリースで対応可（記録必須）
```

## OrchestratorUI連携

```typescript
// 視覚検証Skill呼び出し
/visual-verification

// 実行内容
1. 全画面スクリーンショット自動取得
2. AI分析による問題検出
3. レポート自動生成
4. 問題一覧の作成
```

## 関連ルール
- [uiux-excellence.md](uiux-excellence.md) - UI/UX品質基準
- [release-verification.md](release-verification.md) - リリース検証
- [release-quality-audit.md](release-quality-audit.md) - 品質監査
